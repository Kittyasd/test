//Функция сериализации для множества(массива уникальных значений)
function serialized(mySet) {
    let counter = 0;
    let check = 0;
    let serializedStr = "";
    let mas = Array.from(mySet).sort((a, b) => a - b);

    for (m of mas) {
        if (check + 1 == m) {
            counter++;
        }

        else {
            serializedStr += counter + " ";
            counter = m - check - 1;
            serializedStr += counter  + " ";
            counter = 1;
            }

        check = m;
    }
    serializedStr += counter;

    return serializedStr
}

//Функция десериализации для множества(массива уникальных значений)
function deserialized(mySet) {
    let deserializedStr = "";
    let mas = Array.from(mySet.split(" "));
    let check = true;
    let counter = 0;

    for (m of mas) {
        if (check == true) {
            for (let i = 0; i < m; i++) {
                deserializedStr += ++counter + " ";
            }
            check = false;
        }
        else {
            counter += +m;
            check = true;
        }

    }

    return deserializedStr;
}

//Реализация теста #4
let mySet = new Set();

for (let i = 0; i < 1000; i++) {
    mySet.add(Math.trunc(Math.random() * 300 + 1))
}

console.log(`Исходная строка: ${Array.from(mySet)}`);

let setA = serialized(mySet);
console.log(`Сжатая строка: ${setA}`);

let setB = deserialized(setA);

console.log(`Коэффициент сжатия: ${setB.length / setA.length}`);

/*
Тест #1 (50 рандомных чисел в диапазоне 1..300)
Исходная строка: 145,63,215,84,299,112,25,259,212,117,41,109,9,6,95,151,298,72,93,239,96,62,73,281,119,157,29,57,287,86,142,198,277,101,244,141,292,2,234,190,111,129,103,191,227
Сжатая строка: 0 1 1 3 1 2 1 15 1 3 1 11 1 15 1 4 2 8 2 10 1 1 1 6 1 1 2 4 1 1 1 5 1 1 2 4 1 1 1 9 1 11 2 2 1 5 1 5 1 32 2 6 1 13 1 2 1 11 1 6 1 4 1 4 1 14 1 17 1 3 1 5 1 4 1 5 2
Коэффициент сжатия: 0.9877300613496932

Тест #2 (100 рандомных чисел в диапазоне 1..300)
Исходная строка: 80,81,157,228,94,124,88,95,115,116,266,16,171,209,287,298,204,83,87,269,290,98,231,90,28,280,150,273,245,230,229,173,107,73,215,268,168,299,279,70,30,38,46,222,130,112,76,277,184,288,51,103,49,199,79,34,29,201,186,40,27,259,144,15,185,145,138,203,74,141,271,155,218,146,175,54,177,289,251,182,216,123,20,243,117,131,2,257,189,26
Сжатая строка: 0 1 1 12 2 3 1 5 5 3 1 3 1 1 1 5 1 2 1 1 1 2 1 15 1 2 2 1 1 2 3 1 1 3 2 1 1 3 2 2 1 4 1 3 1 4 1 2 3 5 2 5 2 6 1 2 1 2 3 3 1 4 1 1 1 10 1 2 1 1 1 1 1 1 1 4 1 1 3 2 1 9 1 1 1 1 2 4 1 5 2 1 1 3 1 5 4 11 1 1 1 5 1 
5 1 1 1 6 1 1 2 1 1 1 1 3 1 1 2 6 4 7 2
Коэффициент сжатия: 1.321285140562249

Тест #3 (500 рандомных чисел в диапазоне 1..300)
Исходная строка: 285,220,156,121,267,51,198,258,127,28,151,207,190,139,194,223,134,29,161,4,63,79,76,109,119,252,184,300,112,32,11,272,111,273,231,204,200,270,148,56,82,64,15,116,107,162,26,36,256,39,206,93,202,210,185,35,150,125,167,292,279,297,240,59,12,214,212,205,14,58,65,249,84,173,38,253,102,126,98,131,248,247,31,233,123,83,30,94,170,264,2,85,230,143,89,229,274,235,260,275,52,69,48,17,219,199,255,217,122,5,290,172,250,113,193,155,97,3,149,293,87,259,43,1,158,37,163,34,181,105,44,141,100,179,154,153,47,182,41,54,243,55,16,208,216,129,239,195,138,165,265,183,144,227,33,62,75,88,60,237,262,6,226,263,77,147,10,74,244,298,286,245,201,130,166,211,9,280,120,50,117,169,140,99,236,294,271,136,188,124,46,104,40,203,21,168,152,22,53,278,42,8,24,289,281,86,90,81,80,128,232,20,78,142,174,296,159,178,228,132,114,192,101,269,287,157,222,72,57,108,242,67,196,291,106,221,95,118,137,49,215,27,276,213,261,257,146,73,238
Сжатая строка: 6 1 5 1 4 2 3 1 1 1 19 1 15 1 4 1 1 1 1 2 19 2 3 1 6 1 6 1 4 1 17 1 1 1 9 1 14 1 3 1 6 1 3 3 2 1 5 2 1 1 1 1 5 1 11 1 8 1 5 2 8 1 6 1 4 1 4 1 2 1 11 1 1 1 8 1 4 3 3 1 6 1 3 1 1
Коэффициент сжатия: 5.136363636363637

Тест #4 (1000 рандомных чисел в диапазоне 1..300) 
Исходная строка: 148,235,160,112,242,159,271,3,44,225,207,172,223,83,290,168,208,253,136,13,205,30,89,155,296,171,63,188,293,58,109,66,37,265,286,26,216,68,157,197,15,233,266,166,218,165,186,239,144,184,280,47,219,128,79,90,249,169,181,192,107,56,121,231,146,255,43,277,119,177,267,25,200,39,269,71,252,288,80,118,53,229,64,41,230,138,215,29,12,258,282,243,259,14,120,295,289,247,94,195,150,42,294,87,34,97,78,244,104,256,31,283,86,212,92,101,5,273,209,194,59,220,61,151,113,23,111,272,217,57,236,32,170,76,178,6,35,241,10,36,251,40,163,105,285,70,22,69,260,108,74,262,263,45,299,96,147,93,153,291,135,84,143,175,202,152,62,250,100,17,281,125,48,167,28,298,279,20,73,102,198,140,7,257,110,206,16,203,4,224,117,9,183,238,131,179,1,191,240,141,95,98,72,237,190,214,116,50,49,106,85,124,126,60,270,21,82,211,246,292,187,213,46,134,137,129,284,88,19,278,228,2,24,204,275,185,65,274,261,173,227,81,221,164,52,234,232,276,27,114,154,287,130,161,300,199,264,99,142,201,127,54,162,132,254,158,115,139,55,297,189,180,75,176,149,210,123,33,248,51,133,67,103,77,122,196,11,182,156
Сжатая строка: 7 1 9 1 19 1 52 1 53 1 28 1 18 1 28 1 3 1 18 1 22 1 32
Коэффициент сжатия: 19.5

Тест #5 (100 рандомных чисел в диапазоне 1..9)
Исходная строка: 3,1,6,5,4,2,8,9,7
Сжатая строка: 9
Коэффициент сжатия: 18

Тест #6 (50 рандомных чисел в диапазоне 10..99)
Исходная строка: 34,57,68,25,99,17,75,33,79,58,39,78,87,83,40,29,42,43,94,72,10,74,19,73,16,50,22,46,85,49,86,77,64,13,97,76,45,35,51,66,38,44
Сжатая строка: 0 9 1 2 1 2 2 1 1 2 1 2 1 3 1 3 3 2 3 1 5 2 3 5 2 5 1 1 1 1 1 3 8 3 1 1 3 6 1 2 1 1 1
Коэффициент сжатия: 1.4823529411764707

Тест #7 (300 рандомных чисел в диапазоне 100..300) 
Исходная строка: 114,273,126,187,194,203,230,285,173,100,251,292,268,201,221,220,135,144,296,298,124,289,172,166,297,142,219,131,128,193,239,286,234,148,260,282,178,205,154,115,125,113,255,153,237,141,145,116,177,213,278,199,117,196,151,250,158,111,281,236,127,244,152,197,155,102,180,192,163,257,275,252,121,216,174,139,267,300,228,147,189,238,140,104,277,215,295,133,195,149,249,191,200,186,185,169,261,214,208,284,159,241,256,112,235,210,204,171,254,108,184,182,120,179,198,247,202,272,188,162,290,222,134,225,160,288,206,276,259,232,293,224,168,279,263,143,233,271,101,270,165,226,183,211,262,119,157
Сжатая строка: 0 99 3 1 1 3 1 2 7 1 3 2 5 2 1 1 3 3 7 1 3 1 5 1 4 1 2 1 2 1 2 1 4 2 4 1 8 1 16 1 1 1 2 1 4 2 4 1 3 1 1 1 1 1 8 1 1 2 1 2 1 1 4 1 4 1 5 3 2 1 4 1 5 1 2 1 3 1 3 1 2 1 4 1 1
Коэффициент сжатия: 3.43859649122807

Тест #8 (каждого числа по 3 - всего чисел 900) 
Исходная строка: 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300
Сжатая строка: 300
Коэффициент сжатия: 364
*/